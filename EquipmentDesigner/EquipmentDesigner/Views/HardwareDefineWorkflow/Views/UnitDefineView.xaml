<UserControl x:Class="EquipmentDesigner.Views.HardwareDefineWorkflow.UnitDefine.UnitDefineView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:lex="http://wpflocalizeextension.codeplex.com"
             lex:LocalizeDictionary.DesignCulture="ko"
             lex:ResxLocalizationProvider.DefaultAssembly="EquipmentDesigner"
             lex:ResxLocalizationProvider.DefaultDictionary="Resources.Strings"
             mc:Ignorable="d"
             d:DesignHeight="900" d:DesignWidth="800">

    <Grid>
        <!-- Main Content -->
        <StackPanel>
            <!-- Header -->
            <StackPanel Margin="0,0,0,24">
                <TextBlock Text="{lex:Loc Key=Unit_DefineUnit}"
                           Style="{StaticResource Typography.H3}"
                           Foreground="{StaticResource Brush.Text.Primary}"/>
                <TextBlock Text="{lex:Loc Key=Unit_Description}"
                           Style="{StaticResource Typography.Body}"
                           Foreground="{StaticResource Brush.Text.Secondary}"
                           Margin="0,8,0,0"/>
            </StackPanel>

            <!-- Action Buttons -->
            <StackPanel Orientation="Horizontal" Margin="0,0,0,24">
                <Button Command="{Binding LoadFromServerCommand}"
                        Padding="{StaticResource Spacing.Padding.Button}"
                        Height="{StaticResource Size.Button.Height.MD}"
                        Background="{StaticResource Brush.Button.Secondary.Background}"
                        BorderThickness="0"
                        Cursor="Hand"
                        Margin="0,0,12,0">
                    <StackPanel Orientation="Horizontal">
                        <Path Data="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"
                              Stroke="{StaticResource Brush.Text.Primary}"
                              StrokeThickness="2"
                              Width="16" Height="16"
                              Stretch="Uniform"
                              VerticalAlignment="Center"/>
                        <TextBlock Text="{lex:Loc Key=Equipment_LoadFromServer}"
                                   Style="{StaticResource Typography.Button}"
                                   Foreground="{StaticResource Brush.Text.Primary}"
                                   Margin="8,0,0,0"
                                   VerticalAlignment="Center"/>
                    </StackPanel>
                </Button>
                <Button Command="{Binding AddAnotherCommand}"
                        Padding="{StaticResource Spacing.Padding.Button}"
                        Height="{StaticResource Size.Button.Height.MD}"
                        Background="{StaticResource Brush.Button.Ghost.Background}"
                        BorderBrush="{StaticResource Brush.Border.Primary}"
                        BorderThickness="{StaticResource Border.Thin}"
                        Cursor="Hand">
                    <StackPanel Orientation="Horizontal">
                        <Path Data="M12 4v16m8-8H4"
                              Stroke="{StaticResource Brush.Text.Primary}"
                              StrokeThickness="2"
                              Width="16" Height="16"
                              Stretch="Uniform"
                              VerticalAlignment="Center"/>
                        <TextBlock Text="{lex:Loc Key=Unit_AddAnother}"
                                   Style="{StaticResource Typography.Button}"
                                   Foreground="{StaticResource Brush.Text.Primary}"
                                   Margin="8,0,0,0"
                                   VerticalAlignment="Center"/>
                    </StackPanel>
                </Button>
            </StackPanel>

            <!-- Form Card -->
            <Border Background="{StaticResource Brush.Surface.Primary}"
                    BorderBrush="{StaticResource Brush.Border.Primary}"
                    BorderThickness="{StaticResource Border.Thin}"
                    CornerRadius="{StaticResource Radius.LG}"
                    Padding="{StaticResource Spacing.Padding.Card}"
                    Margin="0,0,0,24">
                <StackPanel>

                    <!-- Parent System ID (Read-only/Display) -->
                    <StackPanel Margin="0,0,0,16"
                                Visibility="{Binding ParentSystemId, Converter={StaticResource BoolToVisibilityConverter}}">
                        <TextBlock Text="{lex:Loc Key=Unit_ParentSystem}"
                                   Style="{StaticResource Typography.Label}"
                                   Foreground="{StaticResource Brush.Text.Primary}"
                                   Margin="0,0,0,6"/>
                        <Border Background="{StaticResource Brush.Background.Tertiary}"
                                CornerRadius="{StaticResource Radius.MD}"
                                Padding="12,8">
                            <TextBlock Text="{Binding ParentSystemId}"
                                       Style="{StaticResource Typography.Body}"
                                       Foreground="{StaticResource Brush.Text.Secondary}"/>
                        </Border>
                    </StackPanel>

                    <!-- Name (Required) -->
                    <StackPanel Margin="0,0,0,16">
                        <TextBlock Style="{StaticResource Typography.Label}"
                                   Foreground="{StaticResource Brush.Text.Primary}"
                                   Margin="0,0,0,6">
                            <Run Text="{lex:Loc Key=Equipment_Name}"/>
                            <Run Text="*" Foreground="{StaticResource Brush.Status.Danger}"/>
                        </TextBlock>
                        <TextBox Text="{Binding Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                 Height="{StaticResource Size.Input.Height.MD}"
                                 Padding="{StaticResource Spacing.Padding.Input}"
                                 Background="{StaticResource Brush.Input.Background}"
                                 BorderBrush="{StaticResource Brush.Input.Border}"
                                 VerticalContentAlignment="Center"/>
                    </StackPanel>

                    <!-- Display Name -->
                    <StackPanel Margin="0,0,0,16">
                        <TextBlock Text="{lex:Loc Key=Equipment_DisplayName}"
                                   Style="{StaticResource Typography.Label}"
                                   Foreground="{StaticResource Brush.Text.Primary}"
                                   Margin="0,0,0,6"/>
                        <TextBox Text="{Binding DisplayName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                 Height="{StaticResource Size.Input.Height.MD}"
                                 Padding="{StaticResource Spacing.Padding.Input}"
                                 Background="{StaticResource Brush.Input.Background}"
                                 BorderBrush="{StaticResource Brush.Input.Border}"
                                 VerticalContentAlignment="Center"/>
                    </StackPanel>

                    <!-- Subname -->
                    <StackPanel Margin="0,0,0,16">
                        <TextBlock Text="{lex:Loc Key=Equipment_Subname}"
                                   Style="{StaticResource Typography.Label}"
                                   Foreground="{StaticResource Brush.Text.Primary}"
                                   Margin="0,0,0,6"/>
                        <TextBox Text="{Binding Subname, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                 Height="{StaticResource Size.Input.Height.MD}"
                                 Padding="{StaticResource Spacing.Padding.Input}"
                                 Background="{StaticResource Brush.Input.Background}"
                                 BorderBrush="{StaticResource Brush.Input.Border}"
                                 VerticalContentAlignment="Center"/>
                    </StackPanel>

                    <!-- Description -->
                    <StackPanel Margin="0,0,0,16">
                        <TextBlock Text="{lex:Loc Key=Equipment_DescriptionLabel}"
                                   Style="{StaticResource Typography.Label}"
                                   Foreground="{StaticResource Brush.Text.Primary}"
                                   Margin="0,0,0,6"/>
                        <TextBox Text="{Binding Description, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                 Height="80"
                                 Padding="{StaticResource Spacing.Padding.Input}"
                                 Background="{StaticResource Brush.Input.Background}"
                                 BorderBrush="{StaticResource Brush.Input.Border}"
                                 TextWrapping="Wrap"
                                 AcceptsReturn="True"
                                 VerticalScrollBarVisibility="Auto"/>
                    </StackPanel>

                    <!-- Implementation Guidelines -->
                    <StackPanel Margin="0,0,0,16">
                        <TextBlock Text="{lex:Loc Key=System_ImplementationGuidelines}"
                                   Style="{StaticResource Typography.Label}"
                                   Foreground="{StaticResource Brush.Text.Primary}"
                                   Margin="0,0,0,6"/>
                        <TextBox Text="{Binding ImplementationGuidelines, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                 Height="100"
                                 Padding="{StaticResource Spacing.Padding.Input}"
                                 Background="{StaticResource Brush.Input.Background}"
                                 BorderBrush="{StaticResource Brush.Input.Border}"
                                 TextWrapping="Wrap"
                                 AcceptsReturn="True"
                                 VerticalScrollBarVisibility="Auto"/>
                    </StackPanel>

                    <!-- Process -->
                    <StackPanel>
                        <TextBlock Text="{lex:Loc Key=Equipment_Process}"
                                   Style="{StaticResource Typography.Label}"
                                   Foreground="{StaticResource Brush.Text.Primary}"
                                   Margin="0,0,0,6"/>
                        <TextBox Text="{Binding Process, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                 Height="{StaticResource Size.Input.Height.MD}"
                                 Padding="{StaticResource Spacing.Padding.Input}"
                                 Background="{StaticResource Brush.Input.Background}"
                                 BorderBrush="{StaticResource Brush.Input.Border}"
                                 VerticalContentAlignment="Center"/>
                    </StackPanel>

                </StackPanel>
            </Border>

            <!-- Commands Section -->
            <Border Background="{StaticResource Brush.Surface.Primary}"
                    BorderBrush="{StaticResource Brush.Border.Primary}"
                    BorderThickness="{StaticResource Border.Thin}"
                    CornerRadius="{StaticResource Radius.LG}"
                    Padding="{StaticResource Spacing.Padding.Card}">
                <StackPanel>
                    <!-- Commands Header -->
                    <Grid Margin="0,0,0,16">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel Grid.Column="0">
                            <TextBlock Text="{lex:Loc Key=System_Commands}"
                                       Style="{StaticResource Typography.H4}"
                                       Foreground="{StaticResource Brush.Text.Primary}"/>
                            <TextBlock Text="{lex:Loc Key=Unit_CommandsDescription}"
                                       Style="{StaticResource Typography.Body.Small}"
                                       Foreground="{StaticResource Brush.Text.Secondary}"
                                       Margin="0,4,0,0"/>
                        </StackPanel>
                        <Button Grid.Column="1"
                                Command="{Binding AddCommandCommand}"
                                Padding="{StaticResource Spacing.Padding.Button}"
                                Height="{StaticResource Size.Button.Height.SM}"
                                Background="{StaticResource Brush.Button.Primary.Background}"
                                BorderThickness="0"
                                Cursor="Hand">
                            <StackPanel Orientation="Horizontal">
                                <Path Data="M12 4v16m8-8H4"
                                      Stroke="{StaticResource Brush.Text.Inverse}"
                                      StrokeThickness="2"
                                      Width="12" Height="12"
                                      Stretch="Uniform"
                                      VerticalAlignment="Center"/>
                                <TextBlock Text="{lex:Loc Key=System_AddCommand}"
                                           Style="{StaticResource Typography.Body.Small}"
                                           Foreground="{StaticResource Brush.Text.Inverse}"
                                           Margin="6,0,0,0"
                                           VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                    </Grid>

                    <!-- Commands List (Card Format) -->
                    <ItemsControl ItemsSource="{Binding Commands}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Background="{StaticResource Brush.Background.Tertiary}"
                                        CornerRadius="{StaticResource Radius.LG}"
                                        Padding="16,12"
                                        Margin="0,0,0,8">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <!-- Command Info -->
                                        <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                            <!-- Command Name (Bold) -->
                                            <TextBlock Text="{Binding Name}"
                                                       Style="{StaticResource Typography.Body}"
                                                       FontWeight="Bold"
                                                       Foreground="{StaticResource Brush.Text.Primary}"/>
                                            <!-- Command Description -->
                                            <TextBlock Text="{Binding Description}"
                                                       Style="{StaticResource Typography.Body.Small}"
                                                       Foreground="{StaticResource Brush.Text.Secondary}"
                                                       TextTrimming="CharacterEllipsis"
                                                       Margin="0,2,0,0"/>
                                            <!-- Parameters Display (type name, type name format) -->
                                            <TextBlock Text="{Binding ParametersDisplayText}"
                                                       Style="{StaticResource Typography.Body.Small}"
                                                       Foreground="{StaticResource Brush.Text.Secondary}"
                                                       Visibility="{Binding ParametersDisplayText, Converter={StaticResource StringToVisibilityConverter}}"
                                                       Margin="0,2,0,0"/>
                                        </StackPanel>

                                        <!-- Remove Button -->
                                        <Button Grid.Column="1"
                                                Command="{Binding DataContext.RemoveCommandCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                CommandParameter="{Binding}"
                                                Background="Transparent"
                                                BorderThickness="0"
                                                Cursor="Hand"
                                                Padding="8"
                                                VerticalAlignment="Center">
                                            <Path Data="M6 18L18 6M6 6l12 12"
                                                  Stroke="{StaticResource Brush.Text.Tertiary}"
                                                  StrokeThickness="2"
                                                  Width="14" Height="14"
                                                  Stretch="Uniform"/>
                                        </Button>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>

                    <!-- Empty State -->
                    <Border Background="{StaticResource Brush.Background.Tertiary}"
                            CornerRadius="{StaticResource Radius.LG}"
                            Padding="24"
                            Visibility="{Binding HasNoCommands, Converter={StaticResource BoolToVisibilityConverter}, FallbackValue=Visible}">
                        <StackPanel HorizontalAlignment="Center">
                            <TextBlock Text="{lex:Loc Key=System_NoCommands}"
                                       Style="{StaticResource Typography.Body}"
                                       Foreground="{StaticResource Brush.Text.Secondary}"
                                       HorizontalAlignment="Center"/>
                            <TextBlock Text="{lex:Loc Key=Unit_NoCommandsHint}"
                                       Style="{StaticResource Typography.Body.Small}"
                                       Foreground="{StaticResource Brush.Text.Tertiary}"
                                       HorizontalAlignment="Center"
                                       Margin="0,4,0,0"/>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Border>
        </StackPanel>
    </Grid>
</UserControl>